{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OBS Scheduler Config File Schema",
  "type": "object",
  "required": [
    "events"
  ],
  "properties": {
    "events": {
      "title": "Events",
      "description": "A list of events for triggering an action within OBS.",
      "type": "array",
      "format": "tabs",
      "items": {
        "title": "Event",
        "description": "A scheduled event for triggering a set action in OBS.",
        "type": "object",
        "required": [
          "schedule_type",
          "action"
        ],
        "properties": {
          "name": {
            "title": "Name",
            "description": "An optional name for the event.",
            "propertyOrder": 1,
            "type": "string"
          },
          "schedule_type": {
            "title": "Schedule Type",
            "propertyOrder": 2,
            "$ref": "#/definitions/ScheduleType"
          },
          "date": {
            "title": "Date",
            "description": "A date/time for when the action should trigger.",
            "propertyOrder": 3,
            "type": "string",
            "format": "datetime-local",
            "options": {
              "dependencies": {
                "schedule_type": "date"
              }
            }
          },
          "schedule": {
            "title": "Schedule",
            "description": "[WIP] A schedule for a repeating event.",
            "propertyOrder": 3,
            "type": "string",
            "options": {
              "dependencies": {
                "schedule_type": "repeating"
              }
            }
          },
          "action": {
            "title": "Action",
            "propertyOrder": 4,
            "$ref": "#/definitions/EventAction"
          },
          "switcher_message": {
            "title": "Advanced Scene Switcher Message",
            "description": "The message to send to Advanced Scene Switcher.",
            "type": "string",
            "options": {
              "dependencies": {
                "action": "advanced_scene_switcher"
              }
            }
          },
          "ws_request": {
            "title": "OBS Websocket Message",
            "$ref": "#/definitions/OBSWSRequest"
          }
        },
        "allOf": [
          {
            "oneOf": [
              {
                "required": [
                  "date"
                ],
                "properties": {
                  "schedule_type": {
                    "const": "date"
                  }
                }
              },
              {
                "required": [
                  "schedule"
                ],
                "properties": {
                  "schedule_type": {
                    "const": "repeating"
                  }
                }
              }
            ]
          },
          {
            "oneOf": [
              {
                "not": {
                  "properties": {
                    "action": {
                      "enum": [
                        "advanced_scene_switcher",
                        "obs_ws"
                      ]
                    }
                  }
                }
              },
              {
                "required": [
                  "switcher_message"
                ],
                "properties": {
                  "action": {
                    "const": "advanced_scene_switcher"
                  }
                }
              },
              {
                "required": [
                  "ws_request"
                ],
                "properties": {
                  "action": {
                    "const": "obs_ws"
                  }
                }
              }
            ]
          }
        ],
        "options": {
          "switcher": false
        }
      }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "ScheduleType": {
      "description": "The type of schedule for an event.",
      "type": "string",
      "enum": [
        "date",
        "repeating"
      ],
      "options": {
        "enum_titles": [
          "Specific Date/Time",
          "Repeating Event"
        ]
      }
    },
    "EventAction": {
      "description": "Which kind of action should be triggered.",
      "type": "string",
      "enum": [
        "start_stream",
        "stop_stream",
        "start_recording",
        "pause_recording",
        "stop_recording",
        "advanced_scene_switcher",
        "obs_ws"
      ],
      "options": {
        "enum_titles": [
          "Start Stream",
          "Stop Stream",
          "Start Recording",
          "Pause Recording",
          "Stop Recording",
          "Advanced Scene Switcher",
          "Raw Websocket"
        ]
      }
    },
    "OBSWSRequest": {
      "description": "A message to send to OBS as a raw Websocket message.",
      "type": "object",
      "required": [
        "type",
        "data"
      ],
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string"
        },
        "data": {
          "type": "object"
        }
      },
      "options": {
        "dependencies": {
          "action": "obs_ws"
        }
      }
    }
  }
}
